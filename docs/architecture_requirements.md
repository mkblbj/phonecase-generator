
# 手机壳商品图自动生成系统架构图（无深度学习版）

本架构图展示了一个不依赖深度学习的商品图自动生成系统的整体模块设计，主要采用 OpenCV 和 Pillow 等传统图像处理技术。

---

## 🧩 系统模块结构图

```mermaid
flowchart TD
    CLI[命令行用户接口 (CLI)]
    CLI --> Args[参数解析模块 argparse]
    Args --> Templates[模板管理模块]
    Args -->|输入路径/批量处理| Batch[批处理控制模块]

    Templates --> Processor[图像处理模块]
    Batch --> Processor

    Processor --> Output[输出与命名模块]
    Templates --> Output
```

---

## 🧰 各模块说明

### ✅ 命令行用户接口（CLI）
- 用户通过命令行使用工具，支持参数如下：
  - `--input`: 单图或文件夹路径
  - `--template`: 使用的模板名或路径
  - `--output`: 输出目录
  - `--quality`, `--resolution`: 可选图像参数

---

### ✅ 参数解析模块（argparse）
- 解析 CLI 命令参数并传递给下游模块
- 统一参数传递结构，方便批处理与模块调用

---

### ✅ 模板管理模块
- 每个模板由：
  - 一张背景图（PNG，带透明）
  - 一个配置文件（JSON/YAML），包含：
    - 嵌入区域坐标
    - 图层顺序、尺寸、角度等规则

---

### ✅ 图像处理模块
- 核心图像处理流程：
  1. 读取手机壳图片
  2. 边缘检测（如 Canny）
  3. 轮廓提取（findContours）
  4. 拟合边框并仿射变换适配模板区域
  5. 使用 Pillow 合成图像到模板中
  6. 调整色彩、透明度等（可选）

---

### ✅ 批处理控制模块
- 支持目录遍历、批量读取手机壳图
- 支持“多图+多模板”的组合处理
- 输出自动命名：如 `{sku}_{template}.png`

---

### ✅ 输出与命名模块
- 根据命名规则输出合成图
- 支持多种图片格式（PNG, JPG, WebP）
- 结果保存到用户指定目录

---

## 🔄 示例流程（处理一张图）

1. 用户执行命令行命令，指定图像与模板
2. 解析参数后读取模板配置与图像
3. 进行图像预处理与模板适配
4. 合成商品图，调整输出设置
5. 保存商品图到目标目录

---

## ✅ 技术栈

| 组件       | 用途           |
|------------|----------------|
| Python 3.8+ | 主语言         |
| OpenCV      | 图像处理（边缘检测、变换等） |
| Pillow      | 图像合成、透明图处理        |
| NumPy       | 图像矩阵运算            |
| argparse    | 命令行参数解析          |
| tqdm        | 显示批处理进度条        |

---

*文档版本: 1.0*  
*最后更新: 2025年4月8日*
